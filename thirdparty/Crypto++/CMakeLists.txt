if (WIN32)
	set(WITH_CRYPTOPP "BUNDLED" CACHE STRING "Use Crypto++ library (SYSTEM/BUNDLED)" FORCE)
else()
	set(WITH_CRYPTOPP "SYSTEM" CACHE STRING "Use Crypto++ library (SYSTEM/BUNDLED)")
endif()
if (WITH_CRYPTOPP STREQUAL "SYSTEM")
	set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake")
	find_package(Crypto++ REQUIRED)
else()
	set(CRYPTOPP_BUILD_TESTING OFF)
	set(CRYPTOPP_DEFAULT_BUILD_TYPE "Release")
	add_subdirectory(cryptopp-cmake)
	add_library(CryptoPP::CryptoPP ALIAS cryptopp)
	if (MSVC)
		target_compile_definitions(cryptopp PRIVATE _SILENCE_ALL_MS_EXT_DEPRECATION_WARNINGS)
	else()
		target_compile_options(cryptopp PRIVATE -fno-strict-aliasing)
	endif()
endif()

cmake_policy(SET CMP0079 NEW)
target_link_libraries(StormByte-Crypto PRIVATE CryptoPP::CryptoPP)